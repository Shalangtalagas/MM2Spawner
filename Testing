local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Initialize required services and modules
local boxmodule = require(game:GetService("ReplicatedStorage").Modules.BoxModule)
local itemdatabase = require(game:GetService("ReplicatedStorage").Database.Sync.Item)

getgenv().newValue = ""

-- Improved function to add items to inventory
local function addItemToInventory(itemName)
    -- Get the player's profile data
    local profileModule = require(game:GetService("ReplicatedStorage").Modules.ProfileData)
    local weapons = profileModule.Weapons
    
    -- Add the item to inventory
    if not weapons.Owned[itemName] then
        weapons.Owned[itemName] = 1
    else
        weapons.Owned[itemName] = weapons.Owned[itemName] + 1
    end
    
    -- Force update inventory
    game:GetService("ReplicatedStorage").RemoteEvents.InventoryUpdate:FireServer(weapons)
    
    -- Update UI (if in inventory screen)
    if game.Players.LocalPlayer.PlayerGui:FindFirstChild("MainGUI") then
        local inventoryScript = game.Players.LocalPlayer.PlayerGui.MainGUI.Inventory.NewItem
        if inventoryScript then
            local hi = getsenv(inventoryScript)._G
            hi.NewItem(itemName, nil, nil, 'Weapons', 1)
        end
    end
    
    return true
end

-- Function to convert display name to raw item name
local function getrawnamebyrealname(realname)
    for i in pairs(itemdatabase) do
        if realname:lower() == i:lower() then
            return i
        end
    end
    return realname -- Return original if not found
end

-- Create the main window
local Window = Rayfield:CreateWindow({
    Name = "Item Spawner",
    LoadingTitle = "Loading Item Spawner",
    LoadingSubtitle = "by Heavenbatumbading",
    ConfigurationSaving = {
        Enabled = false
    },
    Discord = {
        Enabled = false
    },
    KeySystem = false
})

-- Create the main tab
local Tab = Window:CreateTab("Spawner", 4483362458)
Tab:CreateSection("Item Spawning")

-- Item input field
Tab:CreateInput({
    Name = "Item Name",
    PlaceholderText = "Enter item name",
    RemoveTextAfterFocusLost = false,
    Callback = function(Value)
        getgenv().newValue = getrawnamebyrealname(Value)
    end,
})

-- Spawn button
Tab:CreateButton({
    Name = "Spawn Item",
    Callback = function()
        if not getgenv().newValue or getgenv().newValue == "" then
            Rayfield:Notify({
                Title = "Error",
                Content = "Please enter an item name first",
                Duration = 3,
            })
            return
        end

        -- Spawn the item
        local success = addItemToInventory(getgenv().newValue)
        
        if success then
            Rayfield:Notify({
                Title = "Success",
                Content = "Spawned " .. getgenv().newValue .. "\nCheck your inventory!",
                Duration = 3,
            })
        else
            Rayfield:Notify({
                Title = "Error",
                Content = "Failed to spawn item",
                Duration = 3,
            })
        end
    end,
})

-- Load the UI
Rayfield:LoadConfiguration()
